<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-sso/guides/setup-sso/implement-idp-initiated-sso" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.5.2">
<title data-rh="true">Implementing Secure Identity Provider (IdP) Initiated SSO with Scalekit | Scalekit Docs</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://docs-staging.scalekit.com/docs-staging/sso/guides/setup-sso/implement-idp-initiated-sso"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" property="twitter:card" content="summary_large_image"><meta data-rh="true" property="twitter:title" content="Home | Scalekit Docs"><meta data-rh="true" property="twitter:desription" content="Learn how to implement  authentication capabilities through our quick start guides, SDKs and code samples"><meta data-rh="true" property="twitter:image" content="/img/docs_og.png"><meta data-rh="true" property="og:desription" content="Learn how to implement  authentication capabilities through our quick start guides, SDKs and code samples"><meta data-rh="true" property="og:image" content="/img/docs_og.png"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Implementing Secure Identity Provider (IdP) Initiated SSO with Scalekit | Scalekit Docs"><meta data-rh="true" name="description" content="Learn how to securely implement Identity Provider (IdP) initiated Single Sign-On (SSO) in your application using Scalekit. Convert IdP-initiated requests to Service Provider (SP) initiated SSO flow to mitigate security risks like stolen SAML assertions while still providing a seamless login experience for users."><meta data-rh="true" property="og:description" content="Learn how to securely implement Identity Provider (IdP) initiated Single Sign-On (SSO) in your application using Scalekit. Convert IdP-initiated requests to Service Provider (SP) initiated SSO flow to mitigate security risks like stolen SAML assertions while still providing a seamless login experience for users."><meta data-rh="true" name="keywords" content="Identity Provider (IdP) Initiated SSO,Single Sign-On (SSO),Scalekit,SAML Assertions,Service Provider (SP) Initiated SSO,OAuth,Security Risks,Stolen Assertions,Man-In-The-Middle (MITM) Attacks,Open Redirect Attacks,Browser Vulnerabilities,B2B SaaS Security"><link data-rh="true" rel="icon" href="/docs-staging/img/Favicon.svg"><link data-rh="true" rel="canonical" href="https://docs-staging.scalekit.com/docs-staging/sso/guides/setup-sso/implement-idp-initiated-sso"><link data-rh="true" rel="alternate" href="https://docs-staging.scalekit.com/docs-staging/sso/guides/setup-sso/implement-idp-initiated-sso" hreflang="en"><link data-rh="true" rel="alternate" href="https://docs-staging.scalekit.com/docs-staging/sso/guides/setup-sso/implement-idp-initiated-sso" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://7554BDRAJD-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/docs-staging/assets/css/styles.0d5108ea.css">
<script src="/docs-staging/assets/js/runtime~main.e939ae78.js" defer="defer"></script>
<script src="/docs-staging/assets/js/main.5cc05b25.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/docs-staging/"><div class="navbar__logo"><img src="/docs-staging/img/scalekit_docs_logo.svg" alt="Scalekit Docs" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="https://assets-global.website-files.com/65b87d98fa638289e10b8f61/65c269053d86c92e0cf91db5_scalekit-logo.svg" alt="Scalekit Docs" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div></a><div class="navbar__item dropdown dropdown--hoverable"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">Product</a><ul class="dropdown__menu"><li><a href="#" class="dropdown__link"><span class="product-dropdown-label">Choose a product</span></a></li><li><a class="dropdown__link sso" href="/docs-staging/sso/quickstart">Single Sign-on</a></li><li><a class="dropdown__link scim" href="/docs-staging/scim/quickstart">SCIM Provisioning</a></li></ul></div><div class="navbarSearchContainer_Bca1"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20" aria-hidden="true"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/docs-staging/apis">API Reference</a><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a class="navbar__link" aria-haspopup="true" aria-expanded="false" role="button" href="/docs-staging/sdks">SDKs</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/docs-staging/scalekit-by-example/scalekit-by-example">Examples</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">Resources</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/docs-staging/integrations">Integrations</a></li><li><a class="dropdown__link" href="/docs-staging/manage-scalekit/glossary">Glossary</a></li></ul></div><a href="https://www.scalekit.com/?intent=earlyaccess&amp;utm_source=docs" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link loginLink">Get Early Access &rarr;</a></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menuHtmlItem_M9Kj menu__list-item"><span class="text--uppercase text--light sidenav-category-heading">Getting Started</span></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs-staging/sso/overview">Learn SSO Basics</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs-staging/sso/quickstart">SSO - Quickstart</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs-staging/sso/quickstart-admin-portal">Admin Portal</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs-staging/sso/test-sso">Test SSO</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs-staging/sso/launch-checklist">Launch Checklist</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menuHtmlItem_M9Kj menu__list-item"><div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menuHtmlItem_M9Kj menu__list-item"><span class="text--uppercase text--light sidenav-category-heading">Login with Social</span></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs-staging/sso/social-login">Social Login - Quickstart</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menuHtmlItem_M9Kj menu__list-item"><div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menuHtmlItem_M9Kj menu__list-item"><span class="text--uppercase text--light sidenav-category-heading">How-to Guides</span></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs-staging/sso/guides/setup-sso/build-login-page">Add SSO to your Login Page</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs-staging/sso/guides/setup-sso/handle-user-profile">Fetch User Attributes from IdP</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs-staging/sso/domain-and-theme-customization">Customize Admin Portal</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" href="/docs-staging/sso/guides/setup-sso/implement-idp-initiated-sso">Implement IdP Initiated SSO</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs-staging/sso/guides/setup-sso/error-handling">Handle SSO Errors</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs-staging/sso/guides/setup-sso/customize-user-attributes">Customize User Attributes</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs-staging/sso/guides/test-your-integration/using-okta">Test SSO with Okta</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menuHtmlItem_M9Kj menu__list-item"><div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menuHtmlItem_M9Kj menu__list-item"><span class="text--uppercase text--light sidenav-category-heading">Integration Resources</span></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs-staging/sso/guides/integrate-with-your-auth-system/auth0">Integrate with Auth0</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs-staging/sso/guides/integrate-with-your-auth-system/firebase">Integrate with Firebase</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menuHtmlItem_M9Kj menu__list-item"><div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menuHtmlItem_M9Kj menu__list-item"><span class="text--uppercase text--light sidenav-category-heading">Learning Guides</span></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs-staging/sso/guides/key-concepts/authorization-url">Authorization URL</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs-staging/sso/guides/key-concepts/redirect-uri">Redirect URI</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs-staging/sso/guides/key-concepts/idtoken-claims">ID Token Claims</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs-staging/sso/guides/key-concepts/user-profile">Normalized User Profile</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs-staging/sso/guides/key-concepts/manage-client-secrets">Manage Client Secrets</a></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_z5aJ"><div class="docItemContainer_c0TR"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/docs-staging/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Implement IdP Initiated SSO</span><meta itemprop="position" content="1"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Implement Identity Provider (IdP) initiated SSO</h1></header>
<p>IdP-initiated SSO allows users to log into your application directly from their identity provider&#x27;s portal. While
convenient, it poses security risks such as stolen SAML assertions.</p>
<p>In IdP initiated SSO:</p>
<ol>
<li>The user logs into their identity provider portal and selects your application.</li>
<li>The identity provider sends the user&#x27;s details as assertions to your application.</li>
<li>Your application validates the assertions, retrieves the user information, and if everything checks out, logs the
user in.</li>
</ol>
<figure class="width-50"><p><img decoding="async" loading="lazy" alt="IdP initiated SSO workflow" src="/docs-staging/assets/images/idp-initiated-sso-54c30d596f68dfa60e0e44861ac41e32.png" width="3536" height="2168" class="img_ev3q">
</p><figcaption>IdP initiated SSO workflow</figcaption><p></p></figure>
<p>Since the login is initiated from the identity provider&#x27;s portal, this flow is called IdP-initiated SSO.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="security-risks">Security Risks<a href="#security-risks" class="hash-link" aria-label="Direct link to Security Risks" title="Direct link to Security Risks">​</a></h2>
<p><strong>Stolen SAML Assertions</strong>: Attackers can steal these assertions and use them to gain unauthorized access. If an
attacker manages to steal these assertions, they can:</p>
<ul>
<li>Inject them into another service provider, gaining access to that user&#x27;s account</li>
<li>Inject them back into your application with altered assertions, potentially elevating their privileges</li>
</ul>
<p>With a stolen SAML assertion, an attacker can gain access to your application as the compromised user, bypassing the
usual authentication process. This compromised behavior is much harder with Service Provider (SP) initiated SSO flow.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="how-attackers-steal-saml-assertions">How Attackers Steal SAML Assertions<a href="#how-attackers-steal-saml-assertions" class="hash-link" aria-label="Direct link to How Attackers Steal SAML Assertions" title="Direct link to How Attackers Steal SAML Assertions">​</a></h3>
<p>Attackers can steal SAML assertions through various methods:</p>
<ul>
<li><strong>Man-In-The-Middle (MITM) Attacks</strong>: Intercepting and replacing the SAML response during transmission.</li>
<li><strong>Open Redirect Attacks</strong>: Exploiting improper endpoint validation to redirect the SAML response to a malicious
server.</li>
<li><strong>Leaky Logs and Headers</strong>: Sensitive information, including SAML assertions, can be leaked through logs or headers.</li>
<li><strong>Browser-Based Attacks</strong>: Exploiting browser vulnerabilities to steal SAML assertions</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="the-challenge-for-service-providers">The Challenge for Service Providers<a href="#the-challenge-for-service-providers" class="hash-link" aria-label="Direct link to The Challenge for Service Providers" title="Direct link to The Challenge for Service Providers">​</a></h3>
<p>The chief problem with stolen assertions is that everything appears legitimate to the service provider. The message and
assertion are valid, issued by the expected identity provider, and signed with the expected key. However, the service
provider cannot verify whether the assertions are stolen or not. This makes it difficult to detect and prevent
unauthorized access through stolen SAML assertions.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="mitigating-security-risks-convert-idp-initiated-to-sp-initiated-sso">Mitigating Security Risks: Convert IdP-initiated to SP-initiated SSO<a href="#mitigating-security-risks-convert-idp-initiated-to-sp-initiated-sso" class="hash-link" aria-label="Direct link to Mitigating Security Risks: Convert IdP-initiated to SP-initiated SSO" title="Direct link to Mitigating Security Risks: Convert IdP-initiated to SP-initiated SSO">​</a></h2>
<p>Despite the security risks, IdP initiated SSO offers significant convenience to end users, allowing them to easily log
into various applications used within their organization. As such, it&#x27;s important for your application to support it. To
support it securely, convert the incoming IdP-initiated request to an SP-initiated SSO flow. Refer the below diagram for
the recommended workflow from Scalekit.</p>
<figure><p><img decoding="async" loading="lazy" alt="Scalekit&amp;#39;s recommended workflow for IdP initiated SSO" src="/docs-staging/assets/images/idp_initiated_sso_with_scalekit-8c490e6db4b35a7ac94c517726b182b2.png" width="4936" height="4432" class="img_ev3q">
</p><figcaption>Scalekit&#x27;s recommended workflow for IdP initiated SSO</figcaption><p></p></figure>
<ol>
<li>When Scalekit receives an IdP-initiated SSO request from a customer, it sends a request to your configured default
<code class="simple_code">redirect_uri</code> (located in Scalekit Dashboard &gt; API Config &gt; Redirect URIs) with
<code class="simple_code">idp_initiated_login</code> included as a request parameter.</li>
</ol>
<div class="scalar-card"><div class="scalar-card-content scalar-card--muted custom-scroll"><div><div class="CodeBlock_WzW2"><div class="content_jaVp"><pre class="pre_H8NU shiki"><code class="language-xml"><span class="line"><span style="color:#383A42;--shiki-dark:#E1E4E8">https://b2b-app.com/default-redirect-uri</span></span>
<span class="line"><span style="color:#383A42;--shiki-dark:#E1E4E8">  ?idp_initiated_login=&lt;</span><span style="color:#E45649;--shiki-dark:#85E89D">encoded_jwt_token</span><span style="color:#383A42;--shiki-dark:#E1E4E8">&gt;</span></span>
<span class="line"></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn button_xRi0"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div>
<ol start="2">
<li>The <code class="simple_code">idp_initiated_login</code> request parameter is a signed JWT token containing all necessary
details to identify the organization, SSO connection, and user information, enabling you to initiate a new
authorization request.</li>
</ol>
<div class="scalar-card"><div class="scalar-card-content scalar-card--muted custom-scroll"><div><div class="CodeBlock_WzW2"><div class="content_jaVp"><pre class="pre_H8NU shiki"><code class="language-js"><span class="line"><span style="color:#383A42;--shiki-dark:#E1E4E8">{</span></span>
<span class="line"><span style="color:#50A14F;--shiki-dark:#9ECBFF">  &quot;organization_id&quot;</span><span style="color:#383A42;--shiki-dark:#E1E4E8">: </span><span style="color:#50A14F;--shiki-dark:#9ECBFF">&quot;org_225336910XXXX588&quot;</span><span style="color:#383A42;--shiki-dark:#E1E4E8">,</span></span>
<span class="line"><span style="color:#50A14F;--shiki-dark:#9ECBFF">  &quot;connection_id&quot;</span><span style="color:#383A42;--shiki-dark:#E1E4E8">: </span><span style="color:#50A14F;--shiki-dark:#9ECBFF">&quot;conn_22533XXXXX575236&quot;</span><span style="color:#383A42;--shiki-dark:#E1E4E8">,</span></span>
<span class="line"><span style="color:#50A14F;--shiki-dark:#9ECBFF">  &quot;login_hint&quot;</span><span style="color:#383A42;--shiki-dark:#E1E4E8">: </span><span style="color:#50A14F;--shiki-dark:#9ECBFF">&quot;name@example.com&quot;</span><span style="color:#383A42;--shiki-dark:#E1E4E8">,</span></span>
<span class="line"><span style="color:#50A14F;--shiki-dark:#9ECBFF">  &quot;exp&quot;</span><span style="color:#383A42;--shiki-dark:#E1E4E8">: </span><span style="color:#986801;--shiki-dark:#79B8FF">1723042087</span><span style="color:#383A42;--shiki-dark:#E1E4E8">,</span></span>
<span class="line"><span style="color:#50A14F;--shiki-dark:#9ECBFF">  &quot;nbf&quot;</span><span style="color:#383A42;--shiki-dark:#E1E4E8">: </span><span style="color:#986801;--shiki-dark:#79B8FF">1723041787</span><span style="color:#383A42;--shiki-dark:#E1E4E8">,</span></span>
<span class="line"><span style="color:#50A14F;--shiki-dark:#9ECBFF">  &quot;iat&quot;</span><span style="color:#383A42;--shiki-dark:#E1E4E8">: </span><span style="color:#986801;--shiki-dark:#79B8FF">1723041787</span><span style="color:#383A42;--shiki-dark:#E1E4E8">,</span></span>
<span class="line"><span style="color:#50A14F;--shiki-dark:#9ECBFF">  &quot;iss&quot;</span><span style="color:#383A42;--shiki-dark:#E1E4E8">: </span><span style="color:#50A14F;--shiki-dark:#9ECBFF">&quot;https://b2b-app.com&quot;</span></span>
<span class="line"><span style="color:#383A42;--shiki-dark:#E1E4E8">}</span></span>
<span class="line"></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn button_xRi0"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div>
<ol start="3">
<li>You can use any of these three parameters to initiate a new SSO request. Since the user is already logged into their
Identity Provider, they are not prompted to authenticate again, providing a seamless experience while addressing
potential security vulnerabilities associated with IdP-initiated SSO.</li>
</ol>
<div class="scalar-card"><div class="scalar-card-content scalar-card--muted custom-scroll"><div><div class="tabs-container tabList__CuJ"><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_LNqP tabs__item--active">Node.js</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_LNqP">Python</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_LNqP">Go</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_LNqP">Java</li></ul><div class="margin-top--md"><div role="tabpanel" class="tabItem_Ymn6"><div class="CodeBlock_WzW2"><div class="content_jaVp"><pre class="pre_H8NU shiki"><code class="language-javascript"><span class="line"><span style="color:#A0A1A7;--shiki-dark:#6A737D;font-style:italic;--shiki-dark-font-style:inherit">// 1. Default redirect URL is callback with JWT</span></span>
<span class="line"><span style="color:#A626A4;--shiki-dark:#F97583">const</span><span style="color:#383A42;--shiki-dark:#E1E4E8"> { </span><span style="color:#986801;--shiki-dark:#79B8FF">code</span><span style="color:#383A42;--shiki-dark:#E1E4E8">, </span><span style="color:#986801;--shiki-dark:#79B8FF">error_description</span><span style="color:#383A42;--shiki-dark:#E1E4E8">, </span><span style="color:#986801;--shiki-dark:#79B8FF">idp_initiated_login</span><span style="color:#383A42;--shiki-dark:#E1E4E8"> } </span><span style="color:#0184BC;--shiki-dark:#F97583">=</span><span style="color:#383A42;--shiki-dark:#E1E4E8"> req.</span><span style="color:#E45649;--shiki-dark:#E1E4E8">query</span><span style="color:#383A42;--shiki-dark:#E1E4E8">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A626A4;--shiki-dark:#F97583">  if</span><span style="color:#383A42;--shiki-dark:#E1E4E8"> (error_description) {</span></span>
<span class="line"><span style="color:#A626A4;--shiki-dark:#F97583">    return</span><span style="color:#383A42;--shiki-dark:#E1E4E8"> res.</span><span style="color:#4078F2;--shiki-dark:#B392F0">status</span><span style="color:#383A42;--shiki-dark:#E1E4E8">(</span><span style="color:#986801;--shiki-dark:#79B8FF">400</span><span style="color:#383A42;--shiki-dark:#E1E4E8">).</span><span style="color:#4078F2;--shiki-dark:#B392F0">json</span><span style="color:#383A42;--shiki-dark:#E1E4E8">({ </span><span style="color:#E45649;--shiki-dark:#E1E4E8">message</span><span style="color:#0184BC;--shiki-dark:#E1E4E8">:</span><span style="color:#383A42;--shiki-dark:#E1E4E8"> error_description });</span></span>
<span class="line"><span style="color:#383A42;--shiki-dark:#E1E4E8">  }</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#A0A1A7;--shiki-dark:#6A737D;font-style:italic;--shiki-dark-font-style:inherit">// 2. Decode the JWT</span></span>
<span class="line"><span style="color:#A626A4;--shiki-dark:#F97583">if</span><span style="color:#383A42;--shiki-dark:#E1E4E8"> (idp_initiated_login) {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A626A4;--shiki-dark:#F97583">  const</span><span style="color:#383A42;--shiki-dark:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#986801;--shiki-dark:#79B8FF">    connection_id</span><span style="color:#383A42;--shiki-dark:#E1E4E8">,</span></span>
<span class="line"><span style="color:#986801;--shiki-dark:#79B8FF">    organization_id</span><span style="color:#383A42;--shiki-dark:#E1E4E8">,</span></span>
<span class="line"><span style="color:#986801;--shiki-dark:#79B8FF">    login_hint</span><span style="color:#383A42;--shiki-dark:#E1E4E8">,</span></span>
<span class="line"><span style="color:#986801;--shiki-dark:#79B8FF">    relay_state</span></span>
<span class="line"><span style="color:#383A42;--shiki-dark:#E1E4E8">  } </span><span style="color:#0184BC;--shiki-dark:#F97583">=</span><span style="color:#A626A4;--shiki-dark:#F97583"> await</span><span style="color:#383A42;--shiki-dark:#E1E4E8"> scalekit.</span><span style="color:#4078F2;--shiki-dark:#B392F0">getIdpInitiatedLoginClaims</span><span style="color:#383A42;--shiki-dark:#E1E4E8">(idp_initiated_login);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A626A4;--shiki-dark:#F97583">  let</span><span style="color:#383A42;--shiki-dark:#E1E4E8"> options </span><span style="color:#0184BC;--shiki-dark:#F97583">=</span><span style="color:#383A42;--shiki-dark:#E1E4E8"> {};</span></span>
<span class="line"><span style="color:#A0A1A7;--shiki-dark:#6A737D;font-style:italic;--shiki-dark-font-style:inherit">  // Either ONE of the following properties</span></span>
<span class="line"><span style="color:#383A42;--shiki-dark:#E1E4E8">    options[</span><span style="color:#50A14F;--shiki-dark:#9ECBFF">&quot;connectionId&quot;</span><span style="color:#383A42;--shiki-dark:#E1E4E8">] </span><span style="color:#0184BC;--shiki-dark:#F97583">=</span><span style="color:#383A42;--shiki-dark:#E1E4E8"> connection_id</span></span>
<span class="line"><span style="color:#383A42;--shiki-dark:#E1E4E8">    options[</span><span style="color:#50A14F;--shiki-dark:#9ECBFF">&quot;organizationId&quot;</span><span style="color:#383A42;--shiki-dark:#E1E4E8">] </span><span style="color:#0184BC;--shiki-dark:#F97583">=</span><span style="color:#383A42;--shiki-dark:#E1E4E8"> organization_id</span></span>
<span class="line"><span style="color:#383A42;--shiki-dark:#E1E4E8">    options[</span><span style="color:#50A14F;--shiki-dark:#9ECBFF">&quot;loginHint&quot;</span><span style="color:#383A42;--shiki-dark:#E1E4E8">] </span><span style="color:#0184BC;--shiki-dark:#F97583">=</span><span style="color:#383A42;--shiki-dark:#E1E4E8"> login_hint</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A0A1A7;--shiki-dark:#6A737D;font-style:italic;--shiki-dark-font-style:inherit">    // 3. Generate Authorization URL</span></span>
<span class="line"><span style="color:#A626A4;--shiki-dark:#F97583">    const</span><span style="color:#986801;--shiki-dark:#79B8FF"> url</span><span style="color:#0184BC;--shiki-dark:#F97583"> =</span><span style="color:#383A42;--shiki-dark:#E1E4E8"> scalekit.</span><span style="color:#4078F2;--shiki-dark:#B392F0">getAuthorizationUrl</span><span style="color:#383A42;--shiki-dark:#E1E4E8">(</span></span>
<span class="line"><span style="color:#383A42;--shiki-dark:#E1E4E8">      &lt;</span><span style="color:#C18401;--shiki-dark:#79B8FF">redirect_uri</span><span style="color:#383A42;--shiki-dark:#E1E4E8">&gt;,</span></span>
<span class="line"><span style="color:#383A42;--shiki-dark:#E1E4E8">      options</span></span>
<span class="line"><span style="color:#383A42;--shiki-dark:#E1E4E8">    )</span></span>
<span class="line"><span style="color:#383A42;--shiki-dark:#E1E4E8">    return res.redirect(url);</span></span>
<span class="line"><span style="color:#383A42;--shiki-dark:#E1E4E8">  }</span></span>
<span class="line"></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn button_xRi0"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div role="tabpanel" class="tabItem_Ymn6" hidden=""><div class="CodeBlock_WzW2"><div class="content_jaVp"><pre class="pre_H8NU shiki"><code class="language-python"><span class="line"><span style="color:#A0A1A7;--shiki-dark:#6A737D;font-style:italic;--shiki-dark-font-style:inherit"># 1. Default redirect URL is callback with JWT</span></span>
<span class="line"><span style="color:#383A42;--shiki-dark:#E1E4E8">code </span><span style="color:#383A42;--shiki-dark:#F97583">=</span><span style="color:#383A42;--shiki-dark:#E1E4E8"> request.args.get(</span><span style="color:#50A14F;--shiki-dark:#9ECBFF">&#x27;code&#x27;</span><span style="color:#383A42;--shiki-dark:#E1E4E8">)</span></span>
<span class="line"><span style="color:#383A42;--shiki-dark:#E1E4E8">error_description </span><span style="color:#383A42;--shiki-dark:#F97583">=</span><span style="color:#383A42;--shiki-dark:#E1E4E8"> request.args.get(</span><span style="color:#50A14F;--shiki-dark:#9ECBFF">&#x27;error_description&#x27;</span><span style="color:#383A42;--shiki-dark:#E1E4E8">)</span></span>
<span class="line"><span style="color:#383A42;--shiki-dark:#E1E4E8">idp_initiated_login </span><span style="color:#383A42;--shiki-dark:#F97583">=</span><span style="color:#383A42;--shiki-dark:#E1E4E8"> request.args.get(</span><span style="color:#50A14F;--shiki-dark:#9ECBFF">&#x27;idp_initiated_login&#x27;</span><span style="color:#383A42;--shiki-dark:#E1E4E8">)</span></span>
<span class="line"><span style="color:#383A42;--shiki-dark:#E1E4E8">options </span><span style="color:#383A42;--shiki-dark:#F97583">=</span><span style="color:#383A42;--shiki-dark:#E1E4E8"> AuthorizationUrlOptions()</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#A626A4;--shiki-dark:#F97583">if</span><span style="color:#383A42;--shiki-dark:#E1E4E8"> error_description:</span></span>
<span class="line"><span style="color:#A0A1A7;--shiki-dark:#6A737D;font-style:italic;--shiki-dark-font-style:inherit">    # Handle Error</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A0A1A7;--shiki-dark:#6A737D;font-style:italic;--shiki-dark-font-style:inherit"># 2. Decode the JWT</span></span>
<span class="line"><span style="color:#A626A4;--shiki-dark:#F97583">if</span><span style="color:#383A42;--shiki-dark:#E1E4E8"> idp_initiated_login:</span></span>
<span class="line"><span style="color:#383A42;--shiki-dark:#E1E4E8">    claims </span><span style="color:#383A42;--shiki-dark:#F97583">=</span><span style="color:#A626A4;--shiki-dark:#F97583"> await</span><span style="color:#383A42;--shiki-dark:#E1E4E8"> scalekit.get_idp_initiated_login_claims(idp_initiated_login)</span></span>
<span class="line"><span style="color:#383A42;--shiki-dark:#E1E4E8">    connection_id </span><span style="color:#383A42;--shiki-dark:#F97583">=</span><span style="color:#383A42;--shiki-dark:#E1E4E8"> claims.get(</span><span style="color:#50A14F;--shiki-dark:#9ECBFF">&#x27;connection_id&#x27;</span><span style="color:#383A42;--shiki-dark:#E1E4E8">, </span><span style="color:#986801;--shiki-dark:#79B8FF">None</span><span style="color:#383A42;--shiki-dark:#E1E4E8">)</span></span>
<span class="line"><span style="color:#383A42;--shiki-dark:#E1E4E8">    organization_id </span><span style="color:#383A42;--shiki-dark:#F97583">=</span><span style="color:#383A42;--shiki-dark:#E1E4E8"> claims.get(</span><span style="color:#50A14F;--shiki-dark:#9ECBFF">&#x27;organization_id&#x27;</span><span style="color:#383A42;--shiki-dark:#E1E4E8">, </span><span style="color:#986801;--shiki-dark:#79B8FF">None</span><span style="color:#383A42;--shiki-dark:#E1E4E8">)</span></span>
<span class="line"><span style="color:#383A42;--shiki-dark:#E1E4E8">    login_hint </span><span style="color:#383A42;--shiki-dark:#F97583">=</span><span style="color:#383A42;--shiki-dark:#E1E4E8"> claims.get(</span><span style="color:#50A14F;--shiki-dark:#9ECBFF">&#x27;login_hint&#x27;</span><span style="color:#383A42;--shiki-dark:#E1E4E8">, </span><span style="color:#986801;--shiki-dark:#79B8FF">None</span><span style="color:#383A42;--shiki-dark:#E1E4E8">)</span></span>
<span class="line"><span style="color:#383A42;--shiki-dark:#E1E4E8">    relay_state </span><span style="color:#383A42;--shiki-dark:#F97583">=</span><span style="color:#383A42;--shiki-dark:#E1E4E8"> claims.get(</span><span style="color:#50A14F;--shiki-dark:#9ECBFF">&#x27;relay_state&#x27;</span><span style="color:#383A42;--shiki-dark:#E1E4E8">, </span><span style="color:#986801;--shiki-dark:#79B8FF">None</span><span style="color:#383A42;--shiki-dark:#E1E4E8">)</span></span>
<span class="line"><span style="color:#383A42;--shiki-dark:#E1E4E8">    options.connection_id</span><span style="color:#383A42;--shiki-dark:#F97583">=</span><span style="color:#383A42;--shiki-dark:#E1E4E8">connection_id</span></span>
<span class="line"><span style="color:#383A42;--shiki-dark:#E1E4E8">    options.state</span><span style="color:#383A42;--shiki-dark:#F97583">=</span><span style="color:#383A42;--shiki-dark:#E1E4E8">relay_state</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A0A1A7;--shiki-dark:#6A737D;font-style:italic;--shiki-dark-font-style:inherit">    # 3. Generate Authorization URL</span></span>
<span class="line"><span style="color:#383A42;--shiki-dark:#E1E4E8">    authorization_url </span><span style="color:#383A42;--shiki-dark:#F97583">=</span><span style="color:#383A42;--shiki-dark:#E1E4E8"> scalekit.get_authorization_url(</span></span>
<span class="line"><span style="color:#986801;--shiki-dark:#FFAB70">      redirect_uri</span><span style="color:#383A42;--shiki-dark:#F97583">=</span><span style="color:#383A42;--shiki-dark:#E1E4E8">redirect_uri,</span></span>
<span class="line"><span style="color:#986801;--shiki-dark:#FFAB70">      options</span><span style="color:#383A42;--shiki-dark:#F97583">=</span><span style="color:#383A42;--shiki-dark:#E1E4E8">options</span></span>
<span class="line"><span style="color:#383A42;--shiki-dark:#E1E4E8">    )</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A626A4;--shiki-dark:#F97583">    return</span><span style="color:#383A42;--shiki-dark:#E1E4E8"> redirect(url)</span></span>
<span class="line"></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn button_xRi0"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div role="tabpanel" class="tabItem_Ymn6" hidden=""><div class="CodeBlock_WzW2"><div class="content_jaVp"><pre class="pre_H8NU shiki"><code class="language-go"><span class="line"><span style="color:#A0A1A7;--shiki-dark:#6A737D;font-style:italic;--shiki-dark-font-style:inherit">// 1. Default redirect URL is callback with JWT</span></span>
<span class="line"><span style="color:#E45649;--shiki-dark:#E1E4E8">code</span><span style="color:#383A42;--shiki-dark:#F97583"> :=</span><span style="color:#E45649;--shiki-dark:#E1E4E8"> r</span><span style="color:#383A42;--shiki-dark:#E1E4E8">.</span><span style="color:#E45649;--shiki-dark:#E1E4E8">URL</span><span style="color:#383A42;--shiki-dark:#E1E4E8">.</span><span style="color:#4078F2;--shiki-dark:#B392F0">Query</span><span style="color:#383A42;--shiki-dark:#E1E4E8">().</span><span style="color:#4078F2;--shiki-dark:#B392F0">Get</span><span style="color:#383A42;--shiki-dark:#E1E4E8">(</span><span style="color:#50A14F;--shiki-dark:#9ECBFF">&quot;code&quot;</span><span style="color:#383A42;--shiki-dark:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E45649;--shiki-dark:#E1E4E8">err_description</span><span style="color:#383A42;--shiki-dark:#F97583"> :=</span><span style="color:#E45649;--shiki-dark:#E1E4E8"> r</span><span style="color:#383A42;--shiki-dark:#E1E4E8">.</span><span style="color:#E45649;--shiki-dark:#E1E4E8">URL</span><span style="color:#383A42;--shiki-dark:#E1E4E8">.</span><span style="color:#4078F2;--shiki-dark:#B392F0">Query</span><span style="color:#383A42;--shiki-dark:#E1E4E8">().</span><span style="color:#4078F2;--shiki-dark:#B392F0">Get</span><span style="color:#383A42;--shiki-dark:#E1E4E8">(</span><span style="color:#50A14F;--shiki-dark:#9ECBFF">&quot;error_description&quot;</span><span style="color:#383A42;--shiki-dark:#E1E4E8">)</span></span>
<span class="line"><span style="color:#A626A4;--shiki-dark:#F97583">if</span><span style="color:#E45649;--shiki-dark:#E1E4E8"> err_description</span><span style="color:#383A42;--shiki-dark:#F97583"> !=</span><span style="color:#50A14F;--shiki-dark:#9ECBFF"> &quot;&quot;</span><span style="color:#383A42;--shiki-dark:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#E45649;--shiki-dark:#E1E4E8">		http</span><span style="color:#383A42;--shiki-dark:#E1E4E8">.</span><span style="color:#4078F2;--shiki-dark:#B392F0">Error</span><span style="color:#383A42;--shiki-dark:#E1E4E8">(</span><span style="color:#E45649;--shiki-dark:#E1E4E8">w</span><span style="color:#383A42;--shiki-dark:#E1E4E8">, </span><span style="color:#E45649;--shiki-dark:#E1E4E8">err_description</span><span style="color:#383A42;--shiki-dark:#E1E4E8">, </span><span style="color:#E45649;--shiki-dark:#E1E4E8">http</span><span style="color:#383A42;--shiki-dark:#E1E4E8">.</span><span style="color:#E45649;--shiki-dark:#E1E4E8">StatusBadRequest</span><span style="color:#383A42;--shiki-dark:#E1E4E8">)</span></span>
<span class="line"><span style="color:#A626A4;--shiki-dark:#F97583">		return</span></span>
<span class="line"><span style="color:#383A42;--shiki-dark:#E1E4E8">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A0A1A7;--shiki-dark:#6A737D;font-style:italic;--shiki-dark-font-style:inherit">// 2. Decode the JWT</span></span>
<span class="line"><span style="color:#A626A4;--shiki-dark:#F97583">if</span><span style="color:#E45649;--shiki-dark:#E1E4E8"> idpInitiatedLogin</span><span style="color:#383A42;--shiki-dark:#F97583"> :=</span><span style="color:#E45649;--shiki-dark:#E1E4E8"> r</span><span style="color:#383A42;--shiki-dark:#E1E4E8">.</span><span style="color:#E45649;--shiki-dark:#E1E4E8">URL</span><span style="color:#383A42;--shiki-dark:#E1E4E8">.</span><span style="color:#4078F2;--shiki-dark:#B392F0">Query</span><span style="color:#383A42;--shiki-dark:#E1E4E8">().</span><span style="color:#4078F2;--shiki-dark:#B392F0">Get</span><span style="color:#383A42;--shiki-dark:#E1E4E8">(</span><span style="color:#50A14F;--shiki-dark:#9ECBFF">&quot;idp_initiated_login&quot;</span><span style="color:#383A42;--shiki-dark:#E1E4E8">); </span><span style="color:#E45649;--shiki-dark:#E1E4E8">idpInitiatedLogin</span><span style="color:#383A42;--shiki-dark:#F97583"> !=</span><span style="color:#50A14F;--shiki-dark:#9ECBFF"> &quot;&quot;</span><span style="color:#383A42;--shiki-dark:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#E45649;--shiki-dark:#E1E4E8">	claims</span><span style="color:#383A42;--shiki-dark:#E1E4E8">, </span><span style="color:#E45649;--shiki-dark:#E1E4E8">err</span><span style="color:#383A42;--shiki-dark:#F97583"> :=</span><span style="color:#E45649;--shiki-dark:#E1E4E8"> a</span><span style="color:#383A42;--shiki-dark:#E1E4E8">.</span><span style="color:#E45649;--shiki-dark:#E1E4E8">scalekit</span><span style="color:#383A42;--shiki-dark:#E1E4E8">.</span><span style="color:#4078F2;--shiki-dark:#B392F0">GetIdpInitiatedLoginClaims</span><span style="color:#383A42;--shiki-dark:#E1E4E8">(</span><span style="color:#E45649;--shiki-dark:#E1E4E8">idpInitiatedLogin</span><span style="color:#383A42;--shiki-dark:#E1E4E8">)</span></span>
<span class="line"><span style="color:#A626A4;--shiki-dark:#F97583">	if</span><span style="color:#E45649;--shiki-dark:#E1E4E8"> err</span><span style="color:#383A42;--shiki-dark:#F97583"> !=</span><span style="color:#986801;--shiki-dark:#79B8FF"> nil</span><span style="color:#383A42;--shiki-dark:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#E45649;--shiki-dark:#E1E4E8">		http</span><span style="color:#383A42;--shiki-dark:#E1E4E8">.</span><span style="color:#4078F2;--shiki-dark:#B392F0">Error</span><span style="color:#383A42;--shiki-dark:#E1E4E8">(</span><span style="color:#E45649;--shiki-dark:#E1E4E8">w</span><span style="color:#383A42;--shiki-dark:#E1E4E8">, </span><span style="color:#E45649;--shiki-dark:#E1E4E8">err</span><span style="color:#383A42;--shiki-dark:#E1E4E8">.</span><span style="color:#4078F2;--shiki-dark:#B392F0">Error</span><span style="color:#383A42;--shiki-dark:#E1E4E8">(), </span><span style="color:#E45649;--shiki-dark:#E1E4E8">http</span><span style="color:#383A42;--shiki-dark:#E1E4E8">.</span><span style="color:#E45649;--shiki-dark:#E1E4E8">StatusInternalServerError</span><span style="color:#383A42;--shiki-dark:#E1E4E8">)</span></span>
<span class="line"><span style="color:#A626A4;--shiki-dark:#F97583">		return</span></span>
<span class="line"><span style="color:#383A42;--shiki-dark:#E1E4E8">	}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A0A1A7;--shiki-dark:#6A737D;font-style:italic;--shiki-dark-font-style:inherit">	// 3. Generate Authorization URL</span></span>
<span class="line"><span style="color:#E45649;--shiki-dark:#E1E4E8">	options</span><span style="color:#383A42;--shiki-dark:#F97583"> :=</span><span style="color:#C18401;--shiki-dark:#B392F0"> scalekit</span><span style="color:#383A42;--shiki-dark:#E1E4E8">.</span><span style="color:#C18401;--shiki-dark:#B392F0">AuthorizationUrlOptions</span><span style="color:#383A42;--shiki-dark:#E1E4E8">{</span></span>
<span class="line"><span style="color:#A0A1A7;--shiki-dark:#6A737D;font-style:italic;--shiki-dark-font-style:inherit">		// Either ONE of the following properties</span></span>
<span class="line"><span style="color:#E45649;--shiki-dark:#E1E4E8">		ConnectionId</span><span style="color:#383A42;--shiki-dark:#E1E4E8">:   </span><span style="color:#E45649;--shiki-dark:#E1E4E8">claims</span><span style="color:#383A42;--shiki-dark:#E1E4E8">.</span><span style="color:#E45649;--shiki-dark:#E1E4E8">ConnectionID</span><span style="color:#383A42;--shiki-dark:#E1E4E8">,</span></span>
<span class="line"><span style="color:#E45649;--shiki-dark:#E1E4E8">		OrganizationId</span><span style="color:#383A42;--shiki-dark:#E1E4E8">: </span><span style="color:#E45649;--shiki-dark:#E1E4E8">claims</span><span style="color:#383A42;--shiki-dark:#E1E4E8">.</span><span style="color:#E45649;--shiki-dark:#E1E4E8">OrganizationID</span><span style="color:#383A42;--shiki-dark:#E1E4E8">,</span></span>
<span class="line"><span style="color:#E45649;--shiki-dark:#E1E4E8">		LoginHint</span><span style="color:#383A42;--shiki-dark:#E1E4E8">:      </span><span style="color:#E45649;--shiki-dark:#E1E4E8">claims</span><span style="color:#383A42;--shiki-dark:#E1E4E8">.</span><span style="color:#E45649;--shiki-dark:#E1E4E8">LoginHint</span><span style="color:#383A42;--shiki-dark:#E1E4E8">,</span></span>
<span class="line"><span style="color:#383A42;--shiki-dark:#E1E4E8">	}</span></span>
<span class="line"><span style="color:#E45649;--shiki-dark:#E1E4E8">	authUrl</span><span style="color:#383A42;--shiki-dark:#E1E4E8">, </span><span style="color:#E45649;--shiki-dark:#E1E4E8">err</span><span style="color:#383A42;--shiki-dark:#F97583"> :=</span><span style="color:#E45649;--shiki-dark:#E1E4E8"> a</span><span style="color:#383A42;--shiki-dark:#E1E4E8">.</span><span style="color:#E45649;--shiki-dark:#E1E4E8">scalekit</span><span style="color:#383A42;--shiki-dark:#E1E4E8">.</span><span style="color:#4078F2;--shiki-dark:#B392F0">GetAuthorizationUrl</span><span style="color:#383A42;--shiki-dark:#E1E4E8">(</span><span style="color:#E45649;--shiki-dark:#E1E4E8">a</span><span style="color:#383A42;--shiki-dark:#E1E4E8">.</span><span style="color:#E45649;--shiki-dark:#E1E4E8">redirectUrl</span><span style="color:#383A42;--shiki-dark:#E1E4E8">, </span><span style="color:#E45649;--shiki-dark:#E1E4E8">options</span><span style="color:#383A42;--shiki-dark:#E1E4E8">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A626A4;--shiki-dark:#F97583">	if</span><span style="color:#E45649;--shiki-dark:#E1E4E8"> err</span><span style="color:#383A42;--shiki-dark:#F97583"> !=</span><span style="color:#986801;--shiki-dark:#79B8FF"> nil</span><span style="color:#383A42;--shiki-dark:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#E45649;--shiki-dark:#E1E4E8">		http</span><span style="color:#383A42;--shiki-dark:#E1E4E8">.</span><span style="color:#4078F2;--shiki-dark:#B392F0">Error</span><span style="color:#383A42;--shiki-dark:#E1E4E8">(</span><span style="color:#E45649;--shiki-dark:#E1E4E8">w</span><span style="color:#383A42;--shiki-dark:#E1E4E8">, </span><span style="color:#E45649;--shiki-dark:#E1E4E8">err</span><span style="color:#383A42;--shiki-dark:#E1E4E8">.</span><span style="color:#4078F2;--shiki-dark:#B392F0">Error</span><span style="color:#383A42;--shiki-dark:#E1E4E8">(), </span><span style="color:#E45649;--shiki-dark:#E1E4E8">http</span><span style="color:#383A42;--shiki-dark:#E1E4E8">.</span><span style="color:#E45649;--shiki-dark:#E1E4E8">StatusInternalServerError</span><span style="color:#383A42;--shiki-dark:#E1E4E8">)</span></span>
<span class="line"><span style="color:#A626A4;--shiki-dark:#F97583">		return</span></span>
<span class="line"><span style="color:#383A42;--shiki-dark:#E1E4E8">	}</span></span>
<span class="line"><span style="color:#E45649;--shiki-dark:#E1E4E8">	http</span><span style="color:#383A42;--shiki-dark:#E1E4E8">.</span><span style="color:#4078F2;--shiki-dark:#B392F0">Redirect</span><span style="color:#383A42;--shiki-dark:#E1E4E8">(</span><span style="color:#E45649;--shiki-dark:#E1E4E8">w</span><span style="color:#383A42;--shiki-dark:#E1E4E8">, </span><span style="color:#E45649;--shiki-dark:#E1E4E8">r</span><span style="color:#383A42;--shiki-dark:#E1E4E8">, </span><span style="color:#E45649;--shiki-dark:#E1E4E8">authUrl</span><span style="color:#383A42;--shiki-dark:#E1E4E8">.</span><span style="color:#4078F2;--shiki-dark:#B392F0">String</span><span style="color:#383A42;--shiki-dark:#E1E4E8">(), </span><span style="color:#E45649;--shiki-dark:#E1E4E8">http</span><span style="color:#383A42;--shiki-dark:#E1E4E8">.</span><span style="color:#E45649;--shiki-dark:#E1E4E8">StatusFound</span><span style="color:#383A42;--shiki-dark:#E1E4E8">)</span></span>
<span class="line"><span style="color:#383A42;--shiki-dark:#E1E4E8">}</span></span>
<span class="line"></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn button_xRi0"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div role="tabpanel" class="tabItem_Ymn6" hidden=""><div class="CodeBlock_WzW2"><div class="content_jaVp"><pre class="pre_H8NU shiki"><code class="language-java"><span class="line"><span style="color:#A0A1A7;--shiki-dark:#6A737D;font-style:italic;--shiki-dark-font-style:inherit">// 1. Default redirect URL is callback with JWT</span></span>
<span class="line"><span style="color:#383A42;--shiki-dark:#E1E4E8">@</span><span style="color:#A626A4;--shiki-dark:#F97583">GetMapping</span><span style="color:#383A42;--shiki-dark:#E1E4E8">(</span><span style="color:#50A14F;--shiki-dark:#9ECBFF">&quot;/callback&quot;</span><span style="color:#383A42;--shiki-dark:#E1E4E8">)</span></span>
<span class="line"><span style="color:#A626A4;--shiki-dark:#F97583">public</span><span style="color:#C18401;--shiki-dark:#E1E4E8"> RedirectView</span><span style="color:#4078F2;--shiki-dark:#B392F0"> callbackHandler</span><span style="color:#383A42;--shiki-dark:#E1E4E8">(</span></span>
<span class="line"><span style="color:#383A42;--shiki-dark:#E1E4E8">    @</span><span style="color:#A626A4;--shiki-dark:#F97583">RequestParam</span><span style="color:#383A42;--shiki-dark:#E1E4E8">(</span><span style="color:#986801;--shiki-dark:#79B8FF">required</span><span style="color:#383A42;--shiki-dark:#F97583"> =</span><span style="color:#986801;--shiki-dark:#79B8FF"> false</span><span style="color:#383A42;--shiki-dark:#E1E4E8">) </span><span style="color:#C18401;--shiki-dark:#E1E4E8">String</span><span style="color:#383A42;--shiki-dark:#E1E4E8"> code,</span></span>
<span class="line"><span style="color:#383A42;--shiki-dark:#E1E4E8">    @</span><span style="color:#A626A4;--shiki-dark:#F97583">RequestParam</span><span style="color:#383A42;--shiki-dark:#E1E4E8">(</span><span style="color:#986801;--shiki-dark:#79B8FF">required</span><span style="color:#383A42;--shiki-dark:#F97583"> =</span><span style="color:#986801;--shiki-dark:#79B8FF"> false</span><span style="color:#383A42;--shiki-dark:#E1E4E8">,</span></span>
<span class="line"><span style="color:#986801;--shiki-dark:#79B8FF">        name</span><span style="color:#383A42;--shiki-dark:#F97583"> =</span><span style="color:#50A14F;--shiki-dark:#9ECBFF"> &quot;error_description&quot;</span><span style="color:#383A42;--shiki-dark:#E1E4E8">) </span><span style="color:#C18401;--shiki-dark:#E1E4E8">String</span><span style="color:#383A42;--shiki-dark:#E1E4E8"> errorDescription,</span></span>
<span class="line"><span style="color:#383A42;--shiki-dark:#E1E4E8">    @</span><span style="color:#A626A4;--shiki-dark:#F97583">RequestParam</span><span style="color:#383A42;--shiki-dark:#E1E4E8">(</span><span style="color:#986801;--shiki-dark:#79B8FF">required</span><span style="color:#383A42;--shiki-dark:#F97583"> =</span><span style="color:#986801;--shiki-dark:#79B8FF"> false</span><span style="color:#383A42;--shiki-dark:#E1E4E8">,</span></span>
<span class="line"><span style="color:#986801;--shiki-dark:#79B8FF">        name</span><span style="color:#383A42;--shiki-dark:#F97583"> =</span><span style="color:#50A14F;--shiki-dark:#9ECBFF"> &quot;idp_initiated_login&quot;</span><span style="color:#383A42;--shiki-dark:#E1E4E8">) </span><span style="color:#C18401;--shiki-dark:#E1E4E8">String</span><span style="color:#383A42;--shiki-dark:#E1E4E8"> idpInitiatedLoginToken,</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C18401;--shiki-dark:#E1E4E8">    HttpServletResponse</span><span style="color:#383A42;--shiki-dark:#E1E4E8"> response) throws IOException {</span></span>
<span class="line"><span style="color:#A626A4;--shiki-dark:#F97583">  if</span><span style="color:#383A42;--shiki-dark:#E1E4E8"> (errorDescription </span><span style="color:#383A42;--shiki-dark:#F97583">!=</span><span style="color:#986801;--shiki-dark:#79B8FF"> null</span><span style="color:#383A42;--shiki-dark:#E1E4E8">) {</span></span>
<span class="line"><span style="color:#A0A1A7;--shiki-dark:#6A737D;font-style:italic;--shiki-dark-font-style:inherit">    // Handle Errors</span></span>
<span class="line"><span style="color:#383A42;--shiki-dark:#E1E4E8">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A0A1A7;--shiki-dark:#6A737D;font-style:italic;--shiki-dark-font-style:inherit">  // 2. Decode the JWT</span></span>
<span class="line"><span style="color:#A626A4;--shiki-dark:#F97583">  if</span><span style="color:#383A42;--shiki-dark:#E1E4E8"> (idpInitiatedLoginToken </span><span style="color:#383A42;--shiki-dark:#F97583">!=</span><span style="color:#986801;--shiki-dark:#79B8FF"> null</span><span style="color:#383A42;--shiki-dark:#E1E4E8">) {</span></span>
<span class="line"><span style="color:#C18401;--shiki-dark:#E1E4E8">    IdpInitiatedLoginClaims</span><span style="color:#E45649;--shiki-dark:#E1E4E8"> idpInitiatedLoginClaims </span><span style="color:#383A42;--shiki-dark:#F97583">=</span></span>
<span class="line"><span style="color:#E45649;--shiki-dark:#E1E4E8">        scalekit</span><span style="color:#383A42;--shiki-dark:#E1E4E8">.</span><span style="color:#4078F2;--shiki-dark:#B392F0">authentication</span><span style="color:#383A42;--shiki-dark:#E1E4E8">().</span><span style="color:#4078F2;--shiki-dark:#B392F0">getIdpInitiatedLoginClaims</span><span style="color:#383A42;--shiki-dark:#E1E4E8">(</span></span>
<span class="line"><span style="color:#383A42;--shiki-dark:#E1E4E8">            idpInitiatedLoginToken);</span></span>
<span class="line"><span style="color:#A626A4;--shiki-dark:#F97583">    if</span><span style="color:#383A42;--shiki-dark:#E1E4E8"> (idpInitiatedLoginClaims </span><span style="color:#383A42;--shiki-dark:#F97583">==</span><span style="color:#986801;--shiki-dark:#79B8FF"> null</span><span style="color:#383A42;--shiki-dark:#E1E4E8">) {</span></span>
<span class="line"><span style="color:#E45649;--shiki-dark:#E1E4E8">      response</span><span style="color:#383A42;--shiki-dark:#E1E4E8">.</span><span style="color:#4078F2;--shiki-dark:#B392F0">sendError</span><span style="color:#383A42;--shiki-dark:#E1E4E8">(</span><span style="color:#E45649;--shiki-dark:#E1E4E8">HttpStatus</span><span style="color:#383A42;--shiki-dark:#E1E4E8">.</span><span style="color:#E45649;--shiki-dark:#E1E4E8">BAD_REQUEST</span><span style="color:#383A42;--shiki-dark:#E1E4E8">.</span><span style="color:#4078F2;--shiki-dark:#B392F0">value</span><span style="color:#383A42;--shiki-dark:#E1E4E8">(),</span></span>
<span class="line"><span style="color:#50A14F;--shiki-dark:#9ECBFF">          &quot;Invalid idp_initiated_login token&quot;</span><span style="color:#383A42;--shiki-dark:#E1E4E8">);</span></span>
<span class="line"><span style="color:#A626A4;--shiki-dark:#F97583">      return</span><span style="color:#986801;--shiki-dark:#79B8FF"> null</span><span style="color:#383A42;--shiki-dark:#E1E4E8">;</span></span>
<span class="line"><span style="color:#383A42;--shiki-dark:#E1E4E8">    }</span></span>
<span class="line"><span style="color:#A0A1A7;--shiki-dark:#6A737D;font-style:italic;--shiki-dark-font-style:inherit">    // Either ONE of the following</span></span>
<span class="line"><span style="color:#C18401;--shiki-dark:#E1E4E8">    AuthorizationUrlOptions</span><span style="color:#E45649;--shiki-dark:#E1E4E8"> options </span><span style="color:#383A42;--shiki-dark:#F97583">=</span><span style="color:#A626A4;--shiki-dark:#F97583"> new</span><span style="color:#4078F2;--shiki-dark:#B392F0"> AuthorizationUrlOptions</span><span style="color:#383A42;--shiki-dark:#E1E4E8">();</span></span>
<span class="line"><span style="color:#A626A4;--shiki-dark:#F97583">    if</span><span style="color:#383A42;--shiki-dark:#E1E4E8"> (</span><span style="color:#E45649;--shiki-dark:#E1E4E8">idpInitiatedLoginClaims</span><span style="color:#383A42;--shiki-dark:#E1E4E8">.</span><span style="color:#4078F2;--shiki-dark:#B392F0">getConnectionID</span><span style="color:#383A42;--shiki-dark:#E1E4E8">() </span><span style="color:#383A42;--shiki-dark:#F97583">!=</span><span style="color:#986801;--shiki-dark:#79B8FF"> null</span><span style="color:#383A42;--shiki-dark:#E1E4E8">) {</span></span>
<span class="line"><span style="color:#E45649;--shiki-dark:#E1E4E8">      options</span><span style="color:#383A42;--shiki-dark:#E1E4E8">.</span><span style="color:#4078F2;--shiki-dark:#B392F0">setConnectionId</span><span style="color:#383A42;--shiki-dark:#E1E4E8">(</span><span style="color:#E45649;--shiki-dark:#E1E4E8">idpInitiatedLoginClaims</span><span style="color:#383A42;--shiki-dark:#E1E4E8">.</span><span style="color:#4078F2;--shiki-dark:#B392F0">getConnectionID</span><span style="color:#383A42;--shiki-dark:#E1E4E8">());</span></span>
<span class="line"><span style="color:#383A42;--shiki-dark:#E1E4E8">    }</span></span>
<span class="line"><span style="color:#A626A4;--shiki-dark:#F97583">    if</span><span style="color:#383A42;--shiki-dark:#E1E4E8"> (</span><span style="color:#E45649;--shiki-dark:#E1E4E8">idpInitiatedLoginClaims</span><span style="color:#383A42;--shiki-dark:#E1E4E8">.</span><span style="color:#4078F2;--shiki-dark:#B392F0">getOrganizationID</span><span style="color:#383A42;--shiki-dark:#E1E4E8">() </span><span style="color:#383A42;--shiki-dark:#F97583">!=</span><span style="color:#986801;--shiki-dark:#79B8FF"> null</span><span style="color:#383A42;--shiki-dark:#E1E4E8">) {</span></span>
<span class="line"><span style="color:#E45649;--shiki-dark:#E1E4E8">      options</span><span style="color:#383A42;--shiki-dark:#E1E4E8">.</span><span style="color:#4078F2;--shiki-dark:#B392F0">setOrganizationId</span><span style="color:#383A42;--shiki-dark:#E1E4E8">(</span><span style="color:#E45649;--shiki-dark:#E1E4E8">idpInitiatedLoginClaims</span><span style="color:#383A42;--shiki-dark:#E1E4E8">.</span><span style="color:#4078F2;--shiki-dark:#B392F0">getOrganizationID</span><span style="color:#383A42;--shiki-dark:#E1E4E8">());</span></span>
<span class="line"><span style="color:#383A42;--shiki-dark:#E1E4E8">    }</span></span>
<span class="line"><span style="color:#A626A4;--shiki-dark:#F97583">    if</span><span style="color:#383A42;--shiki-dark:#E1E4E8"> (</span><span style="color:#E45649;--shiki-dark:#E1E4E8">idpInitiatedLoginClaims</span><span style="color:#383A42;--shiki-dark:#E1E4E8">.</span><span style="color:#4078F2;--shiki-dark:#B392F0">getLoginHint</span><span style="color:#383A42;--shiki-dark:#E1E4E8">() </span><span style="color:#383A42;--shiki-dark:#F97583">!=</span><span style="color:#986801;--shiki-dark:#79B8FF"> null</span><span style="color:#383A42;--shiki-dark:#E1E4E8">) {</span></span>
<span class="line"><span style="color:#E45649;--shiki-dark:#E1E4E8">      options</span><span style="color:#383A42;--shiki-dark:#E1E4E8">.</span><span style="color:#4078F2;--shiki-dark:#B392F0">setLoginHint</span><span style="color:#383A42;--shiki-dark:#E1E4E8">(</span><span style="color:#E45649;--shiki-dark:#E1E4E8">idpInitiatedLoginClaims</span><span style="color:#383A42;--shiki-dark:#E1E4E8">.</span><span style="color:#4078F2;--shiki-dark:#B392F0">getLoginHint</span><span style="color:#383A42;--shiki-dark:#E1E4E8">());</span></span>
<span class="line"><span style="color:#383A42;--shiki-dark:#E1E4E8">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A0A1A7;--shiki-dark:#6A737D;font-style:italic;--shiki-dark-font-style:inherit">    // 3. Generate Authorization URL</span></span>
<span class="line"><span style="color:#C18401;--shiki-dark:#E1E4E8">    String</span><span style="color:#E45649;--shiki-dark:#E1E4E8"> url </span><span style="color:#383A42;--shiki-dark:#F97583">=</span><span style="color:#E45649;--shiki-dark:#E1E4E8"> scalekit</span><span style="color:#383A42;--shiki-dark:#E1E4E8">.</span><span style="color:#4078F2;--shiki-dark:#B392F0">authentication</span><span style="color:#383A42;--shiki-dark:#E1E4E8">()</span></span>
<span class="line"><span style="color:#383A42;--shiki-dark:#E1E4E8">                     .</span><span style="color:#4078F2;--shiki-dark:#B392F0">getAuthorizationUrl</span><span style="color:#383A42;--shiki-dark:#E1E4E8">(redirectUrl, options)</span></span>
<span class="line"><span style="color:#383A42;--shiki-dark:#E1E4E8">                     .</span><span style="color:#4078F2;--shiki-dark:#B392F0">toString</span><span style="color:#383A42;--shiki-dark:#E1E4E8">();</span></span>
<span class="line"><span style="color:#E45649;--shiki-dark:#E1E4E8">    response</span><span style="color:#383A42;--shiki-dark:#E1E4E8">.</span><span style="color:#4078F2;--shiki-dark:#B392F0">sendRedirect</span><span style="color:#383A42;--shiki-dark:#E1E4E8">(url);</span></span>
<span class="line"><span style="color:#A626A4;--shiki-dark:#F97583">    return</span><span style="color:#986801;--shiki-dark:#79B8FF"> null</span><span style="color:#383A42;--shiki-dark:#E1E4E8">;</span></span>
<span class="line"><span style="color:#383A42;--shiki-dark:#E1E4E8">  }</span></span>
<span class="line"></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn button_xRi0"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></div></div></div>
<p>In case of error, the redirect URI will receive a callback containing the error information as query parameters.</p>
<div class="scalar-card"><div class="scalar-card-content scalar-card--muted custom-scroll"><div><div class="CodeBlock_WzW2"><div class="content_jaVp"><pre class="pre_H8NU shiki"><code class="language-xml"><span class="line"><span style="color:#383A42;--shiki-dark:#E1E4E8">https://b2b-app.com/callback?error=&lt;</span><span style="color:#E45649;--shiki-dark:#85E89D">error_category</span><span style="color:#383A42;--shiki-dark:#E1E4E8">&gt;</span><span style="color:white;--shiki-dark:#FDAEB7;font-style:inherit;--shiki-dark-font-style:italic">&amp;</span><span style="color:#383A42;--shiki-dark:#E1E4E8">error_description=&lt;</span><span style="color:#E45649;--shiki-dark:#85E89D">details</span><span style="color:#383A42;--shiki-dark:#E1E4E8">&gt;</span></span>
<span class="line"></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn button_xRi0"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="advantages">Advantages<a href="#advantages" class="hash-link" aria-label="Direct link to Advantages" title="Direct link to Advantages">​</a></h2>
<p>The advantages of using this approach are:</p>
<ul>
<li><strong>Enhanced Security</strong>: Overcomes the security risks of handling IdP-initiated SSO</li>
<li><strong>Seamless Experience</strong>: The additional redirect is almost instantaneous, providing a smooth user experience</li>
</ul>
<p>By following these steps, you can support IdP-initiated SSO while maintaining a high level of security for your users</p></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs-staging/sso/domain-and-theme-customization"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Customize Admin Portal</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs-staging/sso/guides/setup-sso/error-handling"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Handle SSO Errors</div></a></nav><div class="feedbackFooter"><hr><div class="docsRating"><div>Is this page helpful?<a class="button button--secondary button--outline btn-outline"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 512 512" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M466.27 286.69C475.04 271.84 480 256 480 236.85c0-44.015-37.218-85.58-85.82-85.58H357.7c4.92-12.81 8.85-28.13 8.85-46.54C366.55 31.936 328.86 0 271.28 0c-61.607 0-58.093 94.933-71.76 108.6-22.747 22.747-49.615 66.447-68.76 83.4H32c-17.673 0-32 14.327-32 32v240c0 17.673 14.327 32 32 32h64c14.893 0 27.408-10.174 30.978-23.95 44.509 1.001 75.06 39.94 177.802 39.94 7.22 0 15.22.01 22.22.01 77.117 0 111.986-39.423 112.94-95.33 13.319-18.425 20.299-43.122 17.34-66.99 9.854-18.452 13.664-40.343 8.99-62.99zm-61.75 53.83c12.56 21.13 1.26 49.41-13.94 57.57 7.7 48.78-17.608 65.9-53.12 65.9h-37.82c-71.639 0-118.029-37.82-171.64-37.82V240h10.92c28.36 0 67.98-70.89 94.54-97.46 28.36-28.36 18.91-75.63 37.82-94.54 47.27 0 47.27 32.98 47.27 56.73 0 39.17-28.36 56.72-28.36 94.54h103.99c21.11 0 37.73 18.91 37.82 37.82.09 18.9-12.82 37.81-22.27 37.81 13.489 14.555 16.371 45.236-5.21 65.62zM88 432c0 13.255-10.745 24-24 24s-24-10.745-24-24 10.745-24 24-24 24 10.745 24 24z"></path></svg> Yes</a><a class="button button--secondary button--outline btn-outline"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 512 512" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M466.27 225.31c4.674-22.647.864-44.538-8.99-62.99 2.958-23.868-4.021-48.565-17.34-66.99C438.986 39.423 404.117 0 327 0c-7 0-15 .01-22.22.01C201.195.01 168.997 40 128 40h-10.845c-5.64-4.975-13.042-8-21.155-8H32C14.327 32 0 46.327 0 64v240c0 17.673 14.327 32 32 32h64c11.842 0 22.175-6.438 27.708-16h7.052c19.146 16.953 46.013 60.653 68.76 83.4 13.667 13.667 10.153 108.6 71.76 108.6 57.58 0 95.27-31.936 95.27-104.73 0-18.41-3.93-33.73-8.85-46.54h36.48c48.602 0 85.82-41.565 85.82-85.58 0-19.15-4.96-34.99-13.73-49.84zM64 296c-13.255 0-24-10.745-24-24s10.745-24 24-24 24 10.745 24 24-10.745 24-24 24zm330.18 16.73H290.19c0 37.82 28.36 55.37 28.36 94.54 0 23.75 0 56.73-47.27 56.73-18.91-18.91-9.46-66.18-37.82-94.54C206.9 342.89 167.28 272 138.92 272H128V85.83c53.611 0 100.001-37.82 171.64-37.82h37.82c35.512 0 60.82 17.12 53.12 65.9 15.2 8.16 26.5 36.44 13.94 57.57 21.581 20.384 18.699 51.065 5.21 65.62 9.45 0 22.36 18.91 22.27 37.81-.09 18.91-16.71 37.82-37.82 37.82z"></path></svg> No</a><div class="hidden feedbackContainer"><textarea rows="3" placeholder="Sorry to hear that. How can we help you?"></textarea><a class="button button--secondary button--outline">Send Feedback</a></div></div></div><div class="footerLink"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 512 512" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><circle cx="256" cy="256" r="208" fill="none" stroke-linecap="round" stroke-linejoin="round" stroke-width="32"></circle><circle cx="256" cy="256" r="80" fill="none" stroke-linecap="round" stroke-linejoin="round" stroke-width="32"></circle><path fill="none" stroke-linecap="round" stroke-linejoin="round" stroke-width="32" d="m208 54 8 132m80 0 8-132m-96 404 8-132m80 0 8 132m154-250-132 8m0 80 132 8M54 208l132 8m0 80-132 8"></path></svg>Need help? <a href="mailto:support@scalekit.com">Contact Support</a></div><div class="footerLink"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 512 512" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path fill="none" stroke-miterlimit="10" stroke-width="32" d="M256 80a176 176 0 1 0 176 176A176 176 0 0 0 256 80z"></path><path fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="28" d="M200 202.29s.84-17.5 19.57-32.57C230.68 160.77 244 158.18 256 158c10.93-.14 20.69 1.67 26.53 4.45 10 4.76 29.47 16.38 29.47 41.09 0 26-17 37.81-36.37 50.8S251 281.43 251 296"></path><circle cx="250" cy="348" r="20"></circle></svg>Questions? <a href="mailto:hi@scalekit.com">Contact Us</a></div></div></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#security-risks" class="table-of-contents__link toc-highlight">Security Risks</a><ul><li><a href="#how-attackers-steal-saml-assertions" class="table-of-contents__link toc-highlight">How Attackers Steal SAML Assertions</a></li><li><a href="#the-challenge-for-service-providers" class="table-of-contents__link toc-highlight">The Challenge for Service Providers</a></li></ul></li><li><a href="#mitigating-security-risks-convert-idp-initiated-to-sp-initiated-sso" class="table-of-contents__link toc-highlight">Mitigating Security Risks: Convert IdP-initiated to SP-initiated SSO</a></li><li><a href="#advantages" class="table-of-contents__link toc-highlight">Advantages</a></li></ul></div></div></div></div></main></div></div></div></div>
</body>
</html>