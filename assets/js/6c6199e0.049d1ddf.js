"use strict";(self.webpackChunkscalekit_docs=self.webpackChunkscalekit_docs||[]).push([[1960],{5658:(e,s,i)=>{i.r(s),i.d(s,{assets:()=>l,contentTitle:()=>o,default:()=>h,frontMatter:()=>a,metadata:()=>t,toc:()=>d});var n=i(4848),r=i(8453);const a={},o="Automatic Role Assignment",t={id:"dir-sync/automatically-assign-roles",title:"Automatic Role Assignment",description:"Assing roles to users (in your app) based on their group memberships in their directory.",source:"@site/docs/dir-sync/automatically-assign-roles.mdx",sourceDirName:"dir-sync",slug:"/dir-sync/automatically-assign-roles",permalink:"/docs-staging/dir-sync/automatically-assign-roles",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{},sidebar:"dirSyncSidebar",previous:{title:"Directory User Object",permalink:"/docs-staging/dir-sync/directory-user-object"},next:{title:"Admin Portal",permalink:"/docs-staging/dir-sync/admin-portal"}},l={},d=[{value:"Group-Based Role Assignment",id:"group-based-role-assignment",level:2},{value:"Enabling Group-Based Role Assignment",id:"enabling-group-based-role-assignment",level:2},{value:"Creating Webhook Endpoint",id:"creating-webhook-endpoint",level:2},{value:"Example Event Object",id:"example-event-object",level:2}];function c(e){const s={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",header:"header",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",span:"span",ul:"ul",...(0,r.R)(),...e.components},{CodeWithHeader:a,JsonViewer:o,SimpleCode:t,Subtitle:l,TabItem:d,Tabs:c}=s;return a||p("CodeWithHeader",!0),o||p("JsonViewer",!0),t||p("SimpleCode",!0),l||p("Subtitle",!0),d||p("TabItem",!0),c||p("Tabs",!0),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(s.header,{children:(0,n.jsx)(s.h1,{id:"automatic-role-assignment",children:"Automatic Role Assignment"})}),"\n",(0,n.jsx)(l,{children:(0,n.jsx)(s.p,{children:"Assing roles to users (in your app) based on their group memberships in their directory."})}),"\n",(0,n.jsx)(s.p,{children:"Manually assigning roles to users in your app (e.g., viewer, member, editor, admin) can be time-consuming for administrators, especially in large enterprises where access requirements change frequently. Scalekit allows administrators to set up workflows that automatically inform your app about the roles to assign to users."}),"\n",(0,n.jsx)(s.h2,{id:"group-based-role-assignment",children:"Group-Based Role Assignment"}),"\n",(0,n.jsx)(s.p,{children:'A popular approach for automating role assignment is to create groups in the directory provider. Each group lists the users that should have a specific role in your app. For example, an administrator might create a "GitHub Maintainers" group to grant "maintainer" access to the GitHub app for certain employees.'}),"\n",(0,n.jsx)(s.p,{children:"By leveraging Scalekit's events, your app can be informed about these groups and their members, enabling you to automatically assign the appropriate roles to users."}),"\n",(0,n.jsx)(s.h2,{id:"enabling-group-based-role-assignment",children:"Enabling Group-Based Role Assignment"}),"\n",(0,n.jsx)(s.p,{children:"To enable administrators to map groups to roles in your app:"}),"\n",(0,n.jsxs)(s.ol,{children:["\n",(0,n.jsx)(s.li,{children:"Go to the Scalekit Dashboard"}),"\n",(0,n.jsx)(s.li,{children:'Select Configuration > "Roles"'}),"\n",(0,n.jsx)(s.li,{children:'Toggle "Group Based Role Assignment"'}),"\n",(0,n.jsx)(s.li,{children:"Declare your app's roles"}),"\n"]}),"\n",(0,n.jsx)("figure",{className:"width-75",children:(0,n.jsxs)(s.p,{children:[(0,n.jsx)(s.img,{alt:"How Scalekit works",src:i(3974).A+"",width:"2000",height:"1111"}),"\n",(0,n.jsx)("figcaption",{children:"Adding roles in Scalekit dashboard."})]})}),"\n",(0,n.jsx)(s.admonition,{type:"tip",children:(0,n.jsx)(s.p,{children:"Choose clear Display Names and Descriptions for your roles to help administrators understand the access levels in the Admin Portal."})}),"\n",(0,n.jsx)(s.h2,{id:"creating-webhook-endpoint",children:"Creating Webhook Endpoint"}),"\n",(0,n.jsx)(s.p,{children:"To assign roles based on group membership, your app needs to be informed about groups and their users. Here's an example webhook endpoint using Next.js:"}),"\n",(0,n.jsx)(a,{title:"Webhook Endpoint",children:(0,n.jsx)(c,{groupId:"tech-stack",queryString:!0,children:(0,n.jsx)(d,{value:"nextjs",label:"Next.js",children:(0,n.jsx)(s.pre,{className:"shiki shiki-themes one-light github-dark",style:{backgroundColor:"#FAFAFA","--shiki-dark-bg":"#24292e",color:"#383A42","--shiki-dark":"#e1e4e8"},tabIndex:"0",children:(0,n.jsxs)(s.code,{className:"language-javascript",children:[(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"#A626A4","--shiki-dark":"#F97583"},children:"import"}),(0,n.jsx)(s.span,{style:{color:"#383A42","--shiki-dark":"#E1E4E8"},children:" { "}),(0,n.jsx)(s.span,{style:{color:"#E45649","--shiki-dark":"#E1E4E8"},children:"NextRequest"}),(0,n.jsx)(s.span,{style:{color:"#383A42","--shiki-dark":"#E1E4E8"},children:", "}),(0,n.jsx)(s.span,{style:{color:"#E45649","--shiki-dark":"#E1E4E8"},children:"NextResponse"}),(0,n.jsx)(s.span,{style:{color:"#383A42","--shiki-dark":"#E1E4E8"},children:" } "}),(0,n.jsx)(s.span,{style:{color:"#A626A4","--shiki-dark":"#F97583"},children:"from"}),(0,n.jsx)(s.span,{style:{color:"#50A14F","--shiki-dark":"#9ECBFF"},children:" 'next/server'"}),(0,n.jsx)(s.span,{style:{color:"#383A42","--shiki-dark":"#E1E4E8"},children:";"})]}),"\n",(0,n.jsx)(s.span,{className:"line"}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"#A0A1A7","--shiki-dark":"#6A737D",fontStyle:"italic","--shiki-dark-font-style":"inherit"},children:"/**"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"#A0A1A7","--shiki-dark":"#6A737D",fontStyle:"italic","--shiki-dark-font-style":"inherit"},children:" * Webhook Endpoint: /api/webhook/role-assignment"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"#A0A1A7","--shiki-dark":"#6A737D",fontStyle:"italic","--shiki-dark-font-style":"inherit"},children:" * app/api"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"#A0A1A7","--shiki-dark":"#6A737D",fontStyle:"italic","--shiki-dark-font-style":"inherit"},children:" * \u2514\u2500\u2500 webhook"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"#A0A1A7","--shiki-dark":"#6A737D",fontStyle:"italic","--shiki-dark-font-style":"inherit"},children:" *     \u2514\u2500\u2500 role-assignment"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"#A0A1A7","--shiki-dark":"#6A737D",fontStyle:"italic","--shiki-dark-font-style":"inherit"},children:" *         \u2514\u2500\u2500 route.ts"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"#A0A1A7","--shiki-dark":"#6A737D",fontStyle:"italic","--shiki-dark-font-style":"inherit"},children:" */"})}),"\n",(0,n.jsx)(s.span,{className:"line"}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"#A626A4","--shiki-dark":"#F97583"},children:"export"}),(0,n.jsx)(s.span,{style:{color:"#A626A4","--shiki-dark":"#F97583"},children:" async"}),(0,n.jsx)(s.span,{style:{color:"#A626A4","--shiki-dark":"#F97583"},children:" function"}),(0,n.jsx)(s.span,{style:{color:"#4078F2","--shiki-dark":"#B392F0"},children:" POST"}),(0,n.jsx)(s.span,{style:{color:"#383A42","--shiki-dark":"#E1E4E8"},children:"("}),(0,n.jsx)(s.span,{style:{color:"#383A42","--shiki-dark":"#FFAB70"},children:"req"}),(0,n.jsx)(s.span,{style:{color:"#0184BC","--shiki-dark":"#F97583"},children:":"}),(0,n.jsx)(s.span,{style:{color:"#C18401","--shiki-dark":"#B392F0"},children:" NextRequest"}),(0,n.jsx)(s.span,{style:{color:"#383A42","--shiki-dark":"#E1E4E8"},children:") {"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"#A626A4","--shiki-dark":"#F97583"},children:"  const"}),(0,n.jsx)(s.span,{style:{color:"#986801","--shiki-dark":"#79B8FF"},children:" event"}),(0,n.jsx)(s.span,{style:{color:"#0184BC","--shiki-dark":"#F97583"},children:" ="}),(0,n.jsx)(s.span,{style:{color:"#A626A4","--shiki-dark":"#F97583"},children:" await"}),(0,n.jsx)(s.span,{style:{color:"#383A42","--shiki-dark":"#E1E4E8"},children:" req."}),(0,n.jsx)(s.span,{style:{color:"#4078F2","--shiki-dark":"#B392F0"},children:"json"}),(0,n.jsx)(s.span,{style:{color:"#383A42","--shiki-dark":"#E1E4E8"},children:"();"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"#A626A4","--shiki-dark":"#F97583"},children:"  const"}),(0,n.jsx)(s.span,{style:{color:"#383A42","--shiki-dark":"#E1E4E8"},children:" { "}),(0,n.jsx)(s.span,{style:{color:"#986801","--shiki-dark":"#79B8FF"},children:"email"}),(0,n.jsx)(s.span,{style:{color:"#383A42","--shiki-dark":"#E1E4E8"},children:", "}),(0,n.jsx)(s.span,{style:{color:"#986801","--shiki-dark":"#79B8FF"},children:"name"}),(0,n.jsx)(s.span,{style:{color:"#383A42","--shiki-dark":"#E1E4E8"},children:" } "}),(0,n.jsx)(s.span,{style:{color:"#0184BC","--shiki-dark":"#F97583"},children:"="}),(0,n.jsx)(s.span,{style:{color:"#383A42","--shiki-dark":"#E1E4E8"},children:" event."}),(0,n.jsx)(s.span,{style:{color:"#E45649","--shiki-dark":"#E1E4E8"},children:"data"}),(0,n.jsx)(s.span,{style:{color:"#383A42","--shiki-dark":"#E1E4E8"},children:";"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"#A626A4","--shiki-dark":"#F97583"},children:"  await"}),(0,n.jsx)(s.span,{style:{color:"#4078F2","--shiki-dark":"#B392F0"},children:" assignRole"}),(0,n.jsx)(s.span,{style:{color:"#383A42","--shiki-dark":"#E1E4E8"},children:"(roleName, email);"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"#A626A4","--shiki-dark":"#F97583"},children:"  return"}),(0,n.jsx)(s.span,{style:{color:"#383A42","--shiki-dark":"#E1E4E8"},children:" NextResponse."}),(0,n.jsx)(s.span,{style:{color:"#4078F2","--shiki-dark":"#B392F0"},children:"json"}),(0,n.jsx)(s.span,{style:{color:"#383A42","--shiki-dark":"#E1E4E8"},children:"({ "}),(0,n.jsx)(s.span,{style:{color:"#E45649","--shiki-dark":"#E1E4E8"},children:"status"}),(0,n.jsx)(s.span,{style:{color:"#0184BC","--shiki-dark":"#E1E4E8"},children:":"}),(0,n.jsx)(s.span,{style:{color:"#986801","--shiki-dark":"#79B8FF"},children:" 200"}),(0,n.jsx)(s.span,{style:{color:"#383A42","--shiki-dark":"#E1E4E8"},children:" });"})]}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"#383A42","--shiki-dark":"#E1E4E8"},children:"}"})}),"\n",(0,n.jsx)(s.span,{className:"line"})]})})})})}),"\n",(0,n.jsxs)(s.p,{children:["Register this webhook in the Scalekit Dashboard > Webhooks and subscribe to all group-related events. In this example, ",(0,n.jsxs)(t,{children:["https:",(0,n.jsx)("span",{}),"//",(0,n.jsx)(s.a,{href:"http://www.hero-saas.app/api/webhook/role-assignment",children:"www.hero-saas.app/api/webhook/role-assignment"})]})," is the webhook endpoint."]}),"\n",(0,n.jsx)(s.h2,{id:"example-event-object",children:"Example Event Object"}),"\n",(0,n.jsx)(s.p,{children:"When an administrator creates a group or adds users to a group, Scalekit sends an event object to your app with the necessary information to assign roles."}),"\n",(0,n.jsx)(a,{title:"Group Creation Event",children:(0,n.jsx)(o,{src:{data:{directory_id:"dir_38610496391217780",display_name:"Avengers",external_id:null,id:"dirgroup_38862741498233423",organization_id:"org_38609339635728478",raw_attributes:{displayName:"Avengers",members:null}},environment_id:"env_32080745237316098",id:"evt_38862741515010639",object:"DirectoryGroup",occurred_at:"2024-09-25T02:26:39.036398577Z",organization_id:"org_38609339635728478",spec_version:"1",type:"scalekit.dir.group.create"}})}),"\n",(0,n.jsx)(a,{title:"User Addition to Group Event",children:(0,n.jsx)(o,{src:{data:{directory_id:"dir_38610496391217780",display_name:"Avengers",external_id:null,id:"dirgroup_38862741498233423",organization_id:"org_38609339635728478",raw_attributes:{displayName:"Avengers",members:[{display:"testuser2@gmail.com",value:"diruser_38864946578129487"}]}},environment_id:"env_32080745237316098",id:"evt_38864948910162368",object:"DirectoryGroup",occurred_at:"2024-09-25T02:48:34.745030921Z",organization_id:"org_38609339635728478",spec_version:"1",type:"scalekit.dir.group.update"}})}),"\n",(0,n.jsx)(s.p,{children:"The event data is contained within the data property, while other information about the organization and event type is present at the same level as data in the JSON object."}),"\n",(0,n.jsx)(s.p,{children:"Group-based role assignment offers several benefits:"}),"\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsx)(s.li,{children:"Easy setup for your customers"}),"\n",(0,n.jsx)(s.li,{children:"Flexible role mapping"}),"\n",(0,n.jsx)(s.li,{children:"No need for workarounds"}),"\n",(0,n.jsx)(s.li,{children:"Automatic, realtime role assignment based on events from directory provider"}),"\n"]}),"\n",(0,n.jsxs)(s.p,{children:["By leveraging Scalekit's group-based role assignment, you can streamline access management for your enterprise customers and ensure that user roles stay up-to-date with their directory provider.\nFor more information about event objects, refer to the ",(0,n.jsx)(s.a,{href:"/apis#tag/Webhooks",children:"Events Reference documentation"}),"."]})]})}function h(e={}){const{wrapper:s}={...(0,r.R)(),...e.components};return s?(0,n.jsx)(s,{...e,children:(0,n.jsx)(c,{...e})}):c(e)}function p(e,s){throw new Error("Expected "+(s?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}},3974:(e,s,i)=>{i.d(s,{A:()=>n});const n=i.p+"assets/images/automatically-assign-roles-2-921422957267f90bea5ea32683b4d8bf.png"},8453:(e,s,i)=>{i.d(s,{R:()=>o,x:()=>t});var n=i(6540);const r={},a=n.createContext(r);function o(e){const s=n.useContext(a);return n.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function t(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:o(e.components),n.createElement(a.Provider,{value:s},e.children)}}}]);