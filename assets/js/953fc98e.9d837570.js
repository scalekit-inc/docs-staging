"use strict";(self.webpackChunkscalekit_docs=self.webpackChunkscalekit_docs||[]).push([[5359],{8091:(e,s,i)=>{i.r(s),i.d(s,{assets:()=>l,contentTitle:()=>t,default:()=>h,frontMatter:()=>a,metadata:()=>o,toc:()=>c});var n=i(4848),r=i(8453);const a={displayed_sidebar:"scimSidebar"},t="Automatic Role Assignment",o={id:"scim/automatically-assign-roles",title:"Automatic Role Assignment",description:"Assing roles to users (in your app) based on their group memberships in their directory.",source:"@site/docs/scim/automatically-assign-roles.mdx",sourceDirName:"scim",slug:"/scim/automatically-assign-roles",permalink:"/docs-staging/scim/automatically-assign-roles",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{displayed_sidebar:"scimSidebar"},sidebar:"scimSidebar",previous:{title:"Directory User Object",permalink:"/docs-staging/scim/directory-user-object"},next:{title:"Admin Portal",permalink:"/docs-staging/scim/admin-portal"}},l={},c=[{value:"Introduction",id:"introduction",level:2},{value:"Enabling Group-Based Role Assignment",id:"enabling-group-based-role-assignment",level:2},{value:"Creating Webhook Endpoint",id:"creating-webhook-endpoint",level:2},{value:"Example Event Object",id:"example-event-object",level:2}];function d(e){const s={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",header:"header",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",span:"span",ul:"ul",...(0,r.R)(),...e.components},{CodeWithHeader:a,JsonViewer:t,SimpleCode:o,Subtitle:l,TabItem:c,Tabs:d}=s;return a||p("CodeWithHeader",!0),t||p("JsonViewer",!0),o||p("SimpleCode",!0),l||p("Subtitle",!0),c||p("TabItem",!0),d||p("Tabs",!0),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(s.header,{children:(0,n.jsx)(s.h1,{id:"automatic-role-assignment",children:"Automatic Role Assignment"})}),"\n",(0,n.jsx)(l,{children:(0,n.jsx)(s.p,{children:"Assing roles to users (in your app) based on their group memberships in their directory."})}),"\n",(0,n.jsx)(s.p,{children:"Manually assigning roles to users in your app (e.g., viewer, member, editor,\nadmin) can be time-consuming for administrators, especially in large enterprises\nwhere access requirements change frequently. Scalekit allows administrators to\nset up workflows that automatically inform your app about the roles to assign to\nusers."}),"\n",(0,n.jsx)(s.h2,{id:"introduction",children:"Introduction"}),"\n",(0,n.jsx)(s.p,{children:'A popular approach for automating role assignment is to create groups in the\ndirectory provider. Each group lists the users that should have a specific role\nin your app. For example, an administrator might create a "GitHub Maintainers"\ngroup to grant "maintainer" access to the GitHub app for certain employees.'}),"\n",(0,n.jsx)(s.p,{children:"By leveraging Scalekit's events, your app can be informed about these groups and\ntheir members, enabling you to automatically assign the appropriate roles to\nusers."}),"\n",(0,n.jsx)(s.h2,{id:"enabling-group-based-role-assignment",children:"Enabling Group-Based Role Assignment"}),"\n",(0,n.jsx)(s.p,{children:"To enable administrators to map groups to roles in your app:"}),"\n",(0,n.jsxs)(s.ol,{children:["\n",(0,n.jsx)(s.li,{children:"Go to the Scalekit Dashboard"}),"\n",(0,n.jsx)(s.li,{children:'Select Configuration > "Roles"'}),"\n",(0,n.jsx)(s.li,{children:'Toggle "Group Based Role Assignment"'}),"\n",(0,n.jsx)(s.li,{children:"Create your app's roles"}),"\n"]}),"\n",(0,n.jsx)("figure",{className:"width-75",children:(0,n.jsxs)(s.p,{children:[(0,n.jsx)(s.img,{alt:"How Scalekit works",src:i(8084).A+"",width:"3018",height:"1336"}),"\n",(0,n.jsx)("figcaption",{children:"Adding roles in Scalekit dashboard."})]})}),"\n",(0,n.jsx)(s.p,{children:'The first role you create in your app becomes the default role automatically.\nThis means users who don\'t belong to any specific group will be assigned this\nrole upon account creation. To change the default role, navigate to the role\nsettings, click the "..." menu next to the desired role, select "Edit," and\ntoggle the "Set as default role" option.'}),"\n",(0,n.jsx)(s.admonition,{type:"tip",children:(0,n.jsx)(s.p,{children:"Choose clear Display Names and Descriptions for your roles to help\nadministrators understand the access levels in the Admin Portal."})}),"\n",(0,n.jsx)(s.h2,{id:"creating-webhook-endpoint",children:"Creating Webhook Endpoint"}),"\n",(0,n.jsx)(s.p,{children:"To assign roles based on group membership, your app needs to be informed about\ngroups and their users. Here's an example webhook endpoint using Next.js:"}),"\n",(0,n.jsx)(a,{title:"Webhook Endpoint",children:(0,n.jsx)(d,{groupId:"tech-stack",queryString:!0,children:(0,n.jsx)(c,{value:"nextjs",label:"Next.js",children:(0,n.jsx)(s.pre,{className:"shiki shiki-themes one-light github-dark",style:{backgroundColor:"#FAFAFA","--shiki-dark-bg":"#24292e",color:"#383A42","--shiki-dark":"#e1e4e8"},tabIndex:"0",children:(0,n.jsxs)(s.code,{className:"language-javascript",children:[(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"#A626A4","--shiki-dark":"#F97583"},children:"import"}),(0,n.jsx)(s.span,{style:{color:"#383A42","--shiki-dark":"#E1E4E8"},children:" { "}),(0,n.jsx)(s.span,{style:{color:"#E45649","--shiki-dark":"#E1E4E8"},children:"NextRequest"}),(0,n.jsx)(s.span,{style:{color:"#383A42","--shiki-dark":"#E1E4E8"},children:", "}),(0,n.jsx)(s.span,{style:{color:"#E45649","--shiki-dark":"#E1E4E8"},children:"NextResponse"}),(0,n.jsx)(s.span,{style:{color:"#383A42","--shiki-dark":"#E1E4E8"},children:" } "}),(0,n.jsx)(s.span,{style:{color:"#A626A4","--shiki-dark":"#F97583"},children:"from"}),(0,n.jsx)(s.span,{style:{color:"#50A14F","--shiki-dark":"#9ECBFF"},children:" 'next/server'"}),(0,n.jsx)(s.span,{style:{color:"#383A42","--shiki-dark":"#E1E4E8"},children:";"})]}),"\n",(0,n.jsx)(s.span,{className:"line"}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"#A0A1A7","--shiki-dark":"#6A737D",fontStyle:"italic","--shiki-dark-font-style":"inherit"},children:"/**"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"#A0A1A7","--shiki-dark":"#6A737D",fontStyle:"italic","--shiki-dark-font-style":"inherit"},children:" * Webhook Endpoint: /api/webhook/role-assignment"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"#A0A1A7","--shiki-dark":"#6A737D",fontStyle:"italic","--shiki-dark-font-style":"inherit"},children:" * app/api"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"#A0A1A7","--shiki-dark":"#6A737D",fontStyle:"italic","--shiki-dark-font-style":"inherit"},children:" * \u2514\u2500\u2500 webhook"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"#A0A1A7","--shiki-dark":"#6A737D",fontStyle:"italic","--shiki-dark-font-style":"inherit"},children:" *     \u2514\u2500\u2500 role-assignment"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"#A0A1A7","--shiki-dark":"#6A737D",fontStyle:"italic","--shiki-dark-font-style":"inherit"},children:" *         \u2514\u2500\u2500 route.ts"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"#A0A1A7","--shiki-dark":"#6A737D",fontStyle:"italic","--shiki-dark-font-style":"inherit"},children:" */"})}),"\n",(0,n.jsx)(s.span,{className:"line"}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"#A626A4","--shiki-dark":"#F97583"},children:"export"}),(0,n.jsx)(s.span,{style:{color:"#A626A4","--shiki-dark":"#F97583"},children:" async"}),(0,n.jsx)(s.span,{style:{color:"#A626A4","--shiki-dark":"#F97583"},children:" function"}),(0,n.jsx)(s.span,{style:{color:"#4078F2","--shiki-dark":"#B392F0"},children:" POST"}),(0,n.jsx)(s.span,{style:{color:"#383A42","--shiki-dark":"#E1E4E8"},children:"("}),(0,n.jsx)(s.span,{style:{color:"#383A42","--shiki-dark":"#FFAB70"},children:"req"}),(0,n.jsx)(s.span,{style:{color:"#0184BC","--shiki-dark":"#F97583"},children:":"}),(0,n.jsx)(s.span,{style:{color:"#C18401","--shiki-dark":"#B392F0"},children:" NextRequest"}),(0,n.jsx)(s.span,{style:{color:"#383A42","--shiki-dark":"#E1E4E8"},children:") {"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"#A626A4","--shiki-dark":"#F97583"},children:"  const"}),(0,n.jsx)(s.span,{style:{color:"#986801","--shiki-dark":"#79B8FF"},children:" event"}),(0,n.jsx)(s.span,{style:{color:"#0184BC","--shiki-dark":"#F97583"},children:" ="}),(0,n.jsx)(s.span,{style:{color:"#A626A4","--shiki-dark":"#F97583"},children:" await"}),(0,n.jsx)(s.span,{style:{color:"#383A42","--shiki-dark":"#E1E4E8"},children:" req."}),(0,n.jsx)(s.span,{style:{color:"#4078F2","--shiki-dark":"#B392F0"},children:"json"}),(0,n.jsx)(s.span,{style:{color:"#383A42","--shiki-dark":"#E1E4E8"},children:"();"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"#A626A4","--shiki-dark":"#F97583"},children:"  const"}),(0,n.jsx)(s.span,{style:{color:"#383A42","--shiki-dark":"#E1E4E8"},children:" { "}),(0,n.jsx)(s.span,{style:{color:"#986801","--shiki-dark":"#79B8FF"},children:"email"}),(0,n.jsx)(s.span,{style:{color:"#383A42","--shiki-dark":"#E1E4E8"},children:", "}),(0,n.jsx)(s.span,{style:{color:"#986801","--shiki-dark":"#79B8FF"},children:"name"}),(0,n.jsx)(s.span,{style:{color:"#383A42","--shiki-dark":"#E1E4E8"},children:" } "}),(0,n.jsx)(s.span,{style:{color:"#0184BC","--shiki-dark":"#F97583"},children:"="}),(0,n.jsx)(s.span,{style:{color:"#383A42","--shiki-dark":"#E1E4E8"},children:" event."}),(0,n.jsx)(s.span,{style:{color:"#E45649","--shiki-dark":"#E1E4E8"},children:"data"}),(0,n.jsx)(s.span,{style:{color:"#383A42","--shiki-dark":"#E1E4E8"},children:";"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"#A626A4","--shiki-dark":"#F97583"},children:"  await"}),(0,n.jsx)(s.span,{style:{color:"#4078F2","--shiki-dark":"#B392F0"},children:" assignRole"}),(0,n.jsx)(s.span,{style:{color:"#383A42","--shiki-dark":"#E1E4E8"},children:"(roleName, email);"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"#A626A4","--shiki-dark":"#F97583"},children:"  return"}),(0,n.jsx)(s.span,{style:{color:"#383A42","--shiki-dark":"#E1E4E8"},children:" NextResponse."}),(0,n.jsx)(s.span,{style:{color:"#4078F2","--shiki-dark":"#B392F0"},children:"json"}),(0,n.jsx)(s.span,{style:{color:"#383A42","--shiki-dark":"#E1E4E8"},children:"({ "}),(0,n.jsx)(s.span,{style:{color:"#E45649","--shiki-dark":"#E1E4E8"},children:"message"}),(0,n.jsx)(s.span,{style:{color:"#0184BC","--shiki-dark":"#E1E4E8"},children:":"}),(0,n.jsx)(s.span,{style:{color:"#50A14F","--shiki-dark":"#9ECBFF"},children:' "Role assigned"'}),(0,n.jsx)(s.span,{style:{color:"#383A42","--shiki-dark":"#E1E4E8"},children:" }, { "}),(0,n.jsx)(s.span,{style:{color:"#E45649","--shiki-dark":"#E1E4E8"},children:"status"}),(0,n.jsx)(s.span,{style:{color:"#0184BC","--shiki-dark":"#E1E4E8"},children:":"}),(0,n.jsx)(s.span,{style:{color:"#986801","--shiki-dark":"#79B8FF"},children:" 201"}),(0,n.jsx)(s.span,{style:{color:"#383A42","--shiki-dark":"#E1E4E8"},children:" });"})]}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"#383A42","--shiki-dark":"#E1E4E8"},children:"}"})}),"\n",(0,n.jsx)(s.span,{className:"line"})]})})})})}),"\n",(0,n.jsxs)(s.p,{children:["Register this webhook in the Scalekit Dashboard > Webhooks and subscribe to all\ngroup-related events. In this example,\n",(0,n.jsxs)(o,{children:["https:",(0,n.jsx)("span",{}),"//www",(0,n.jsx)("span",{}),".hero-saas.app",(0,n.jsx)("span",{}),"/api/webhook/role-assignment"]}),"\nis the webhook endpoint."]}),"\n",(0,n.jsx)(s.h2,{id:"example-event-object",children:"Example Event Object"}),"\n",(0,n.jsx)(s.p,{children:"When an administrator creates a group or adds users to a group, Scalekit sends\nan event object to your app with the necessary information to assign roles."}),"\n",(0,n.jsx)(a,{title:"Group Creation Event",children:(0,n.jsx)(t,{src:{data:{directory_id:"dir_38610496391217780",display_name:"Avengers",external_id:null,id:"dirgroup_38862741498233423",organization_id:"org_38609339635728478",raw_attributes:{displayName:"Avengers",members:null}},environment_id:"env_32080745237316098",id:"evt_38862741515010639",object:"DirectoryGroup",occurred_at:"2024-09-25T02:26:39.036398577Z",organization_id:"org_38609339635728478",spec_version:"1",type:"scalekit.dir.group.create"}})}),"\n",(0,n.jsx)(a,{title:"User Addition to Group Event",children:(0,n.jsx)(t,{src:{data:{directory_id:"dir_38610496391217780",display_name:"Avengers",external_id:null,id:"dirgroup_38862741498233423",organization_id:"org_38609339635728478",raw_attributes:{displayName:"Avengers",members:[{display:"testuser2@gmail.com",value:"diruser_38864946578129487"}]}},environment_id:"env_32080745237316098",id:"evt_38864948910162368",object:"DirectoryGroup",occurred_at:"2024-09-25T02:48:34.745030921Z",organization_id:"org_38609339635728478",spec_version:"1",type:"scalekit.dir.group.update"}})}),"\n",(0,n.jsx)(s.p,{children:"The event data is contained within the data property, while other information\nabout the organization and event type is present at the same level as data in\nthe JSON object."}),"\n",(0,n.jsx)(s.p,{children:"Group-based role assignment offers several benefits:"}),"\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsx)(s.li,{children:"Easy setup for your customers"}),"\n",(0,n.jsx)(s.li,{children:"Flexible role mapping"}),"\n",(0,n.jsx)(s.li,{children:"No need for workarounds"}),"\n",(0,n.jsx)(s.li,{children:"Automatic, realtime role assignment based on events from directory provider"}),"\n"]}),"\n",(0,n.jsxs)(s.p,{children:["By leveraging Scalekit's group-based role assignment, you can streamline access\nmanagement for your enterprise customers and ensure that user roles stay\nup-to-date with their directory provider. For more information about event\nobjects, refer to the ",(0,n.jsx)(s.a,{href:"/apis#tag/Webhooks",children:"Events Reference documentation"}),"."]})]})}function h(e={}){const{wrapper:s}={...(0,r.R)(),...e.components};return s?(0,n.jsx)(s,{...e,children:(0,n.jsx)(d,{...e})}):d(e)}function p(e,s){throw new Error("Expected "+(s?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}},8084:(e,s,i)=>{i.d(s,{A:()=>n});const n=i.p+"assets/images/automatically-assign-roles-3-614c13b875c26aa40bb6c1893cad7085.png"},8453:(e,s,i)=>{i.d(s,{R:()=>t,x:()=>o});var n=i(6540);const r={},a=n.createContext(r);function t(e){const s=n.useContext(a);return n.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function o(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:t(e.components),n.createElement(a.Provider,{value:s},e.children)}}}]);